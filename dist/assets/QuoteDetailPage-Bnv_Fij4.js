import{u as g,j as e,m as x,C as w,M as N,X as y,l as v,e as _,a as q,r as c,s as u}from"./index-BsN2_pnW.js";import{L as E}from"./LazyImage-C9DSb03t.js";import{A as C}from"./arrow-left-D92mxbb0.js";import{D as Q}from"./dollar-sign-9btXrtQu.js";import{C as D}from"./clock-DGqH9gDW.js";import{C as k}from"./check-circle-UCtte7y5.js";const A=({quote:s,onAccept:a,onDecline:i})=>{const r=g(),o=d=>new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-500 text-white p-5",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(x.button,{onClick:()=>r("/account/quotes"),className:"mr-3 p-1 rounded-full hover:bg-white/20",whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx(C,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-xl font-bold",children:"Custom Price Quote"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium",children:s.item_name}),e.jsx("div",{className:"px-3 py-1 bg-white/20 rounded-full text-sm",children:"Quote Ready - Awaiting Your Decision"})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 mb-8",children:[e.jsxs("div",{className:"w-full md:w-2/5",children:[s.image_url&&s.image_url.length>0?e.jsx("div",{className:"aspect-square rounded-xl overflow-hidden bg-gray-100 shadow-md",children:e.jsx(E,{src:s.image_url[0],alt:s.item_name,className:"w-full h-full object-cover",width:"100%",height:"100%"})}):e.jsx("div",{className:"aspect-square rounded-xl bg-gray-100 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400",children:"No image available"})}),e.jsxs("div",{className:"mt-3 flex items-center text-gray-500 text-sm",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:["Submitted on ",o(s.created_at)]})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Your Request"}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-4",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:s.description})})]}),s.admin_note&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Facility Comment"}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 border-l-4 border-blue-400",children:e.jsx("p",{className:"text-blue-800",children:s.admin_note})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-green-50 rounded-xl p-5 flex items-center",children:[e.jsx("div",{className:"w-14 h-14 bg-green-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx(Q,{className:"w-7 h-7 text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-green-700 mb-1",children:"Quoted Price"}),e.jsxs("div",{className:"text-3xl font-bold text-green-800",children:["€",(s.admin_price||s.facility_suggestion_price||0).toFixed(2)]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-5 flex items-center",children:[e.jsx("div",{className:"w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx(D,{className:"w-7 h-7 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-blue-700 mb-1",children:"Estimated Return"}),e.jsxs("div",{className:"text-xl font-medium text-blue-800",children:[s.suggested_time||s.estimated_days||"3–4"," working days"]})]})]})]}),s.facility_name&&e.jsxs("div",{className:"flex items-center text-gray-600 mb-8",children:[e.jsx(N,{className:"w-5 h-5 mr-2 text-gray-400"}),e.jsx("span",{children:s.facility_name})]}),s.status==="quoted"&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative group w-full sm:w-auto",children:[e.jsxs(x.button,{onClick:i,className:"w-full flex items-center justify-center px-6 py-3 bg-white border border-gray-300 text-gray-700 rounded-xl font-medium hover:bg-gray-50 transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(y,{className:"w-5 h-5 mr-2 text-red-500"}),"Decline Quote"]}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:[e.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-1/2 rotate-45 w-2 h-2 bg-gray-800"}),"Declining will cancel this order request"]})]}),e.jsxs(x.button,{onClick:a,className:"w-full sm:w-auto flex-1 flex items-center justify-center px-6 py-3 bg-green-600 text-white rounded-xl font-medium shadow-md hover:bg-green-700 transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(k,{className:"w-5 h-5 mr-2"}),"Accept Quote & Continue"]})]})]})]})},H=()=>{const{id:s}=v(),a=g(),{user:i}=_();q();const[r,o]=c.useState(null),[d,m]=c.useState(!0),[h,l]=c.useState(null);c.useEffect(()=>{if(!i){a("/login");return}if(!s){a("/account/quotes");return}f()},[s,i,a]);const f=async()=>{try{if(m(!0),l(null),!s||!(i!=null&&i.id))throw new Error("Invalid quote ID or user not authenticated");const{data:t,error:n}=await u.from("custom_price_quotes").select("*").eq("id",s).eq("user_id",i.id).single();if(n)throw n;if(!t)throw new Error("Quote not found");o(t)}catch(t){console.error("Error fetching quote:",t),l(t instanceof Error?t.message:"Failed to load quote")}finally{m(!1)}},p=async()=>{try{if(r.status!=="quoted")throw new Error('Can only accept quotes in "quoted" status');const{error:t}=await u.from("custom_price_quotes").update({status:"accepted"}).eq("id",r.id).eq("status","quoted");if(t)throw t;const n={id:r.id,name:r.item_name,description:r.description,price:r.admin_price||r.facility_suggestion_price||r.suggested_price,quantity:1,is_custom_quote:!1};a("/order/address",{state:{service:"custom",items:{[r.id]:n},type:"standard"}})}catch(t){console.error("Error accepting quote:",t),l(t instanceof Error?t.message:"Failed to accept quote")}},b=async()=>{try{if(r.status!=="quoted")throw new Error('Can only decline quotes in "quoted" status');const{error:t}=await u.from("custom_price_quotes").update({status:"declined"}).eq("id",r.id).eq("status","quoted");if(t)throw t;a("/account/quotes")}catch(t){console.error("Error declining quote:",t),l(t instanceof Error?t.message:"Failed to decline quote")}};if(d)return e.jsx("div",{className:"min-h-screen pt-24 pb-12 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-gray-50 to-white",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded mb-4"}),e.jsx("div",{className:"h-24 bg-gray-200 rounded mb-4"}),e.jsx("div",{className:"h-12 bg-gray-200 rounded mb-4"})]})})});if(h||!r)return e.jsx("div",{className:"min-h-screen pt-24 pb-12 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-gray-50 to-white",children:e.jsx("div",{className:"max-w-2xl mx-auto text-center",children:e.jsxs("div",{className:"bg-red-50 rounded-xl p-6 border border-red-100",children:[e.jsx("h2",{className:"text-xl font-bold text-red-700 mb-2",children:"Error"}),e.jsx("p",{className:"text-red-600 mb-4",children:h||"Quote not found"}),e.jsx("button",{onClick:()=>a("/account/quotes"),className:"px-4 py-2 bg-red-600 text-white rounded-lg",children:"Back to Quotes"})]})})});const j={...r,facility_name:"Eazyy Facility Amsterdam",estimated_days:r.suggested_time||3};return e.jsx("div",{className:"min-h-screen pt-24 pb-12 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-gray-50 to-white",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(A,{quote:j,onAccept:p,onDecline:b,onBack:()=>a("/account/quotes")})})})};export{H as default};
