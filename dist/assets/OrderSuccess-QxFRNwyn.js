import{d as h,u as p,e as g,f as y,r as l,j as e,m as c,s as u}from"./index-BsN2_pnW.js";import{C as f}from"./check-circle-2-DAVociYa.js";import{A as b}from"./arrow-right-CJwG2D7Q.js";const k=()=>{const m=h(),t=p(),{user:x}=g(),{clearCart:n}=y(),r=m.state,[w,d]=l.useState(!1),[N,i]=l.useState(null);return l.useEffect(()=>{if(!(r!=null&&r.orderNumber)){t("/");return}(async()=>{try{d(!0),i(null),console.log("Checking order:",r.orderNumber);const{data:s,error:a}=await u.from("orders").select("status").eq("order_number",r.orderNumber).maybeSingle();if(a)throw console.error("Error checking order:",a),console.error("Query details:",{orderNumber:r.orderNumber,query:"select status from orders where order_number = $1"}),new Error(`Failed to fetch order: ${a.message}`);if(!s)throw console.warn("Order not found:",r.orderNumber),new Error("Order not found");if(console.log("Found order:",s),s.status==="pending"){console.log("Order status is pending, proceeding with update.");const{error:o}=await u.from("orders").update({status:"awaiting_pickup_customer",payment_status:"paid",payment_method:"test"}).eq("order_number",r.orderNumber).eq("status","pending");if(o)throw console.error("Error updating order:",o),new Error(`Failed to update order status: ${o.message}`);console.log("Order updated successfully")}else console.log("Order already processed:",s.status);n()}catch(s){console.error("Error updating order status:",s),i(s instanceof Error?s.message:"Failed to update order status")}finally{d(!1)}})()},[r==null?void 0:r.orderNumber,t,x,n]),r!=null&&r.orderNumber?e.jsx("div",{className:"min-h-screen pt-24 pb-12 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-gray-50 to-white",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-100 mb-6",children:e.jsx(f,{className:"w-10 h-10 text-green-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Order Successful!"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Thank you for your order. Your laundry is in good hands!"})]}),r&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Order Summary"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-600",children:"Order Number"}),e.jsx("span",{className:"font-medium text-gray-900",children:r.orderNumber})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-600",children:"Total Amount"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["€",r.totalAmount.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsx("span",{className:"text-gray-600",children:"Estimated Delivery"}),e.jsx("span",{className:"font-medium text-gray-900",children:typeof r.estimatedDelivery=="string"?new Date(r.estimatedDelivery).toLocaleString():r.estimatedDelivery})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-2xl p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"What's Next?"}),e.jsxs("div",{className:"space-y-3 text-gray-600",children:[e.jsx("p",{children:"• You'll receive a confirmation email with your order details"}),e.jsx("p",{children:"• We'll notify you when your laundry is picked up"}),e.jsx("p",{children:"• Track your order status in the app or website"}),e.jsx("p",{children:"• Get updates on delivery progress"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs(c.button,{onClick:()=>t("/account/orders"),className:"w-full sm:w-auto px-6 py-3 bg-blue-600 text-white rounded-xl font-medium shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center",whileHover:{scale:1.05},whileTap:{scale:.95},children:["View Order Status",e.jsx(b,{className:"w-5 h-5 ml-2"})]}),e.jsx(c.button,{onClick:()=>t("/"),className:"w-full sm:w-auto px-6 py-3 bg-gray-100 text-gray-700 rounded-xl font-medium hover:bg-gray-200 transition-all duration-300",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Back to Home"})]})]})}):null};export{k as default};
